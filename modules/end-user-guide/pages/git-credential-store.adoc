:navtitle: Creating a {orch-name} Secret for a Git credentials store
:keywords: user-guide, configuring, user, secrets
:page-aliases: 

[id="mounting-a-git-credential-store-into-workspace-containers_{context}"]
= Creating a {orch-name} Secret for a Git credentials store

This section describes how to create a Secret containing a Git credentials store in the user's {orch-namespace}. The Git credentials store specified in the Secret is mounted as a file in the {devworkspace}'s containers.

.Prerequisites

* A running instance of {prod-short}.
* You have CLI or GUI access to the {orch-name} cluster of your organization's {prod-short} instance.

ifeval::["{project-context}" == "che"]
** For CLI users: `{orch-cli}` is installed in the operating system you are using. See link:https://kubernetes.io/docs/tasks/tools/#kubectl[Install Tools: kubectl].
endif::[]

ifeval::["{project-context}" == "crw"]
** For CLI users: `{orch-cli}` is installed in the operating system you are using. See link:https://docs.openshift.com/container-platform/4.10/cli_reference/openshift_cli/getting-started-cli.html#installing-openshift-cli[Installing the OpenShift CLI].
endif::[]

* For CLI users: link:https://www.gnu.org/software/coreutils/base64[`base64`] is installed in the operating system you are using. For Mac users, `base64` is available (as part of `coreutils`) on link:https://formulae.brew.sh/formula/coreutils[homebrew].

.Procedure
. In your home directory, locate and open your `.git-credentials` file if you already have it. Alternatively, if you do not have this file, save a new `.git-credentials` file, using the link:https://git-scm.com/docs/git-credential-store#_storage_format[Git credentials storage format]. Each credential is stored on its own line in the file:

+
[subs="+quotes,+attributes,+macros"]
----
https://__<username>__:__<token>__@__<git_server_hostname>__
----

+
.A line in a `.git-credentials` file
====
`https://trailblazer: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@github.com`
====

. Select credentials from your `.git-credentials` file for the Secret. Encode the selected credentials to Base64 for the next step.
+
[TIP]
====
CLI users can create a Base64-encoded string by running `base64`:
* To encode all lines in the file:
** `$ cat .git-credentials | base64 | tr -d '\n'`
* To encode a selected line:
** `$ echo -n '__<copied_and_pasted_line_from_.git-credentials>__' | base64`
====

. Create a new {platforms-name} secret in the user's {orch-namespace}.
+
[source,yaml,subs="+quotes,+attributes,+macros"]
----
apiVersion: v1
kind: Secret
metadata:
  name: git-credentials-secret
  labels:
    controller.devfile.io/git-credential: 'true' <1>
    controller.devfile.io/watch-secret: 'true'
data:
  credentials: __<Base64_content_of_.git-credentials>__ <2>
----
+
<1> The `controller.devfile.io/git-credential` label marks the Secret as containing Git credentials. All Git credential Secrets in your user {orch-namespace} will be merged into a single Secret that will be mounted to the {devworkspace} containers. All of your original Secrets remain intact.
<2> The Git credentials store content encoded with `base64`.

+
[TIP]
====
Optionally, a container path to mount the merged Git credentials Secret can be provided. This can be done by setting the `controller.devfile.io/mount-path` annotation to a Git credntial Secret. For example, if set to `/tmp/git-credentials`, the merged Git credentials store is mounted at `/tmp/git-credentials/credentials`.
====

. Use the CLI or GUI to apply the Secret to the {orch-name} cluster of your organization's {prod-short} instance.
+
For CLI users: Apply the Secret by entering it with `{orch-cli}`:
+
[subs="+quotes,+attributes,+macros"]
----
$ {orch-cli} apply -f - <<EOF
__<Secret_prepared_in_the_previous_step>__
EOF
----

.Additional resources

* link:https://git-scm.com/docs/git-credential-store[Documentation for git-credential-store]
