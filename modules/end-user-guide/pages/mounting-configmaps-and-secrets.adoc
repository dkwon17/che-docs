:navtitle: Mounting ConfigMaps and Secrets
:keywords: user-guide, configuring, user, configmaps, configmap, secret, secrets, mounting, mount
:page-aliases:

[id="mounting-configmaps-and-secrets_{context}"]
= Mounting ConfigMaps and Secrets

ConfigMaps are {platforms-name} objects that store non-confidential data such as configuration values for an application.

Secrets are {platforms-name} objects that store confidential data such as user names, passwords, authentication tokens, and configurations in an encrypted form.

This section describes how to automatically mount {orch-name} ConfigMaps and Secrets to all {devworkspace} containers, creating permanent mount points for components such as:

* Maven configuration, such as the `settings.xml` file 
* SSH key pairs
* AWS authorization tokens
* Configuration files
* Git credentials store files

.Prerequisites

* A running instance of {prod-short}.
* You have CLI or GUI access to the {orch-name} cluster of your organization's {prod-short} instance.
* For CLI users: The `{orch-cli}` command line tool is installed in the operating system you are using.

.Procedure

. Determine an existing ConfigMap or Secret in your user {orch-namespace} to mount to all {devworkspace} containers.

. Set the required labels for mounting.
* For mounting a ConfigMap, CLI users can run:
+
[subs="+quotes,+attributes,+macros"]
----
$ {orch-cli} label configmap __<ConfigMap_name>__ controller.devfile.io/mount-to-devworkspace=true controller.devfile.io/watch-configmap=true
----

* For mounting a Secret, CLI users can run: 
+
[subs="+quotes,+attributes,+macros"]
----
$ {orch-cli} label secret __<Secret_name>__ controller.devfile.io/mount-to-devworkspace=true controller.devfile.io/watch-secret=true
----

. Optionally configure how the ConfigMap or Secret is mounted using the following annotations:
+
.Optional annotations
|===
|Annotation                        | Description
|`controller.devfile.io/mount-path`
a| Path to where the resource should be mounted.

* For ConfigMaps, defaults to `/etc/config/<configmap-name>`.
* For Secrets, defaults to `/etc/secret/<secret-name>`.

|`controller.devfile.io/mount-as`
a| Set to `file`, `subpath` or `env` to specify how the resource should be mounted. Defaults to `file`.

* If set to `file`, keys and values of the resource will be mounted as files within the mount path.
* If set to `subpath`, keys and values of the resource will be mounted as files within the mount path using subpath volume mounts.
* If set to `env`, the keys and values in the resource will be mounted as environment variables in all containers in the {devworkspace}.
|===

See the following examples:

.Mounting a Secret as a file
====
[source,yaml,subs="+quotes"]
----
apiVersion: v1
kind: Secret
metadata:
  name: mvn-settings-secret
  labels:
    controller.devfile.io/mount-to-devworkspace: 'true'
    controller.devfile.io/watch-secret: 'true'
  annotations:
    controller.devfile.io/mount-path: '/home/user/.m2'
data:
  settings.xml: __<Base64-encoded content>__
----

When a {devworkspace} starts, the `/home/user/.m2/settings.xml` file will be available in the {devworkspace} containers.
====


.Mounting a ConfigMap as environment variables
====
[source,yaml,subs="+quotes"]
----
kind: ConfigMap
apiVersion: v1
metadata:
  name: my-settings
  labels:
    controller.devfile.io/mount-to-devworkspace: 'true'
    controller.devfile.io/watch-configmap: 'true'
  annotations:
    controller.devfile.io/mount-as: env
data:
  FOO_1: bar
  FOO_2: bar
----

When a {devworkspace} starts, environment variables `FOO_1` and `FOO_2` will be available in the {devworkspace} containers.
====
